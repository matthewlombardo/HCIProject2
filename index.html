<!DOCTYPE html>
<html>
<head>
<!-- Add jquery to clear object -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* @import url('https://fonts.googleapis.com/css2?family=Arvo&display=swap'); */
@import url('https://fonts.googleapis.com/css2?family=Bitter:wght@700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans&display=swap');

h1,h2 {
	font-family: 'Bitter', serif;
}

h3 {
	font-weight: normal;
	color: #334;
}

body {
	background-color: #FBFAED;
	font-family: 'IBM Plex Sans', sans-serif;
}

.dropbtn {
  background-color: #2980B9;
  color: white;
  padding: 12px;
  font-size: 12px;
  border: 1px;
  cursor: pointer;
}

.dropbtn:hover, .dropbtn:focus {
  background-color: #2980B9;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  overflow: auto;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown a:hover {background-color: #ddd;}

.show {display: block;}

#wrapper {
	width: 1200px;
	margin-left: auto;
	margin-right: auto;
}
</style>
</head>

<body>
	<div id="wrapper">
<h1 style="text-align: center;">Voting Access</h1>
<h3 style="text-align: center;">Team Members: Cindy Koo, Stephan Kemper, & Matthew Lombardo</h3>
<p>Amidst the United States 2020 Presidential Election...</p>


<!-- -->
<!-- MAPS -->
<!-- -->

<h2>Part I: Racial/Ethnic Background & Turnout Rate</h2>
<p>DESCRIPTION OF WHAT THIS IS</p>

<div style="float:left">
<div class="dropdown">
  <button onclick="myFunction1()" class="dropbtn">Please select map!</button>
  <div id="myDropdown" class="dropdown-content">
    <a href="#home" onclick=makeMap1('red')>Red Map</a>
    <a href="#about" onclick=makeMap1('blue')>Blue Map</a>
    <a href="#contact" onclick=makeMap1('green')>Green Map</a>
  </div>
</div>
<script>
function myFunction1() {
  document.getElementById("myDropdown").classList.toggle("show");
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
<p></p>
<!-- Create an element where the map will take place -->

<svg id="my_dataviz" width="400" height="400"></svg>
<script>
function makeMap1(color) {
  // The svg
  var svg = d3.select("#my_dataviz")
  //var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height");

  // Map and projection
  var path = d3.geoPath();
  var projection = d3.geoMercator()
    .scale(70)
    .center([0,20])
    .translate([width / 2, height / 2]);

  // Data and color scale
  var data = d3.map();
  if (color=='red') {
  var colorScale = d3.scaleThreshold()
    .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
    .range(d3.schemeReds[7]);
    }
    else if (color=='blue') {
    var colorScale = d3.scaleThreshold()
    .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
    .range(d3.schemeBlues[7]);
    }
    else if (color=='green') {
    var colorScale = d3.scaleThreshold()
    .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
    .range(d3.schemeGreens[7]);
    }


  // Load external data and boot

  d3.queue()
    .defer(d3.json, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson")
    .defer(d3.csv, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world_population.csv", function(d) { data.set(d.code, +d.pop); })
    .await(ready);
	//.defer(d3.json, "https://raw.githubusercontent.com/OpenDataDE/State-zip-code-GeoJSON/master/nc_north_carolina_zip_codes_geo.min.json")



  function ready(error, topo) {

    // Draw the map
    svg.append("g")
      .selectAll("path")
      .data(topo.features)
      .enter()
      .append("path")
        // draw each country
        .attr("d", d3.geoPath()
          .projection(projection)
        )
        // set the color of each country
        .attr("fill", function (d) {
          d.total = data.get(d.id) || 0;
          return colorScale(d.total);
        })
      }

}
</script>
</div>

<div style="float:right">
<div class="dropdown">
  <button onclick="myFunction2()" class="dropbtn">Please select map!</button>
  <div id="myDropdown2" class="dropdown-content">
    <a href="#home" onclick=makeMap2('red')>Red Map 2</a>
    <a href="#about" onclick=makeMap2('blue')>Blue Map 2</a>
    <a href="#contact" onclick=makeMap2('green')>Green Map 2</a>
  </div>
</div>
<script>
function myFunction2() {
  document.getElementById("myDropdown2").classList.toggle("show");
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
<p></p>
<!-- Create an element where the map will take place -->

<svg id="my_dataviz2" width="400" height="400"></svg>
<script>
function makeMap2(color) {

  // The svg
  var svg = d3.select("#my_dataviz2")
  //var svg2 = d3.select("svg2"),
    width = +svg.attr("width"),
    height = +svg.attr("height");

  // Map and projection
  var path = d3.geoPath();
  var projection = d3.geoMercator()
    .scale(70)
    .center([0,20])
    .translate([width / 2, height / 2]);

  // Data and color scale
  var data = d3.map();
  if (color=='red') {
  var colorScale = d3.scaleThreshold()
    .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
    .range(d3.schemeReds[7]);
    }
    else if (color=='blue') {
    var colorScale = d3.scaleThreshold()
    .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
    .range(d3.schemeBlues[7]);
    }
    else if (color=='green') {
    var colorScale = d3.scaleThreshold()
    .domain([100000, 1000000, 10000000, 30000000, 100000000, 500000000])
    .range(d3.schemeGreens[7]);
    }


  // Load external data and boot
  d3.queue()
    .defer(d3.json, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson")
    .defer(d3.csv, "https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world_population.csv", function(d) { data.set(d.code, +d.pop); })
    .await(ready);


  function ready(error, topo) {

    // Draw the map
    svg.append("g")
      .selectAll("path")
      .data(topo.features)
      .enter()
      .append("path")
        // draw each country
        .attr("d", d3.geoPath()
          .projection(projection)
        )
        // set the color of each country
        .attr("fill", function (d) {
          d.total = data.get(d.id) || 0;
          return colorScale(d.total);
        })
      }

}
</script>
</div>

<hr style="clear:both;">


<p><!-- Blank so button formats correctly --> </p>

<!-- -->
<!-- BAR GRAPHS -->
<!-- -->

<h2>Part II: Voting History & Demographic Information</h2>
<p>HI CINDY! When I said this would be done by 10:15, I meant 11:45... :)</p>

<p>These bar graphs are the voter data for North Carolina for the 2020 General
	 Election (Nov 3). For age groups, the # on the x axis denotes the bottom
	 of an age group; i.e. "10" represents "10-19". For race, the abbreviations
	 are as follows: W=White, B=Black or African American, A=Asian, IA/AN =
	 Indian American or Alaska Native, U=Undesignated, 2+=Two or More Races,
	 O=Other, & NH/PI=Native Hawaiian or Pacific Islander. I had to abbreviate
	 cuz the names were too long and were overlapping on the graph. If you could
	 include some sort of key or footnote that'd be grrrrrrrrreat! </p>

<p> The stacked colors are political parties. Red is Republican, Blue is Democrat,
	and that orange color is Unaffiliated (a surprisingly large number!). There is
	also Libertarian (green), Constitution Party (yellow), and Green Party (black).
	If you look closely you can see little slivers of these (The order on the graph
	is R->D->L->U->C->G). Some kind of key/explanation of this would be great as well.
</p>

<p> We gotta fix the cut off y-axis labels and center the 2 graphs better, but
	for now you should have what you need for anaylsis. We can also change the
	colors cuz these are ugly. Lemme know if you have any
	issues. You da best ! </p>

<div style="float:left">
<div class="dropdown">
  <button onclick="myFunction3()" class="dropbtn">Please select demographic:</button>
  <div id="myDropdown3" class="dropdown-content">
    <a href="#home" onclick=colorGraph1('age')>Age Group</a>
    <a href="#about" onclick=colorGraph1('sex')>Sex</a>
    <a href="#contact" onclick=colorGraph1('race')>Race</a>
  </div>
</div>
<script>
function myFunction3() {
  document.getElementById("myDropdown3").classList.toggle("show");
}
</script>
<p> <!--blank line to put button on top --> </p>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<svg id="my_dataviz3" width="600" height="400"></svg>
<script>
function colorGraph1(demographic) {

// set the dimensions and margins of the graph
var margin = {top: 10, right: 30, bottom: 20, left: 50},
    width = 460 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;

// append the svg object to the body of the page
$("#my_dataviz3").empty();
var svg = d3.select("#my_dataviz3")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");


// Parse the Data
var urls = ["https://raw.githubusercontent.com/matthewlombardo/HCIProject2/master/graph1AGE.csv","https://raw.githubusercontent.com/matthewlombardo/HCIProject2/master/graph1SEX.csv","https://raw.githubusercontent.com/matthewlombardo/HCIProject2/master/graph1RACE.csv"];
var filename;
if (demographic=='age') {
	filename = urls[0];
}
else if (demographic=='sex'){
	filename = urls[1];
}
else if (demographic=='race'){
	filename = urls[2];
}

d3.csv(filename, function(data) {

  // List of subgroups = header of the csv files = soil condition here
  var subgroups = data.columns.slice(1)
  console.log(subgroups)

  // List of groups = species here = value of the first column called group -> I show them on the X axis
  var groups;
  var domain;
  if (demographic=='age') {
	  groups = d3.map(data, function(d){return(d.AGEGROUP)}).keys()
	  domain = 1000000;
  }
  else if (demographic=='sex'){
	  groups = d3.map(data, function(d){return(d.SEX)}).keys()
	  domain = 2500000;
  }
  else if (demographic=='race'){
	  groups = d3.map(data, function(d){return(d.RACE)}).keys()
	  domain = 3500000;
  }
  //var groups = d3.map(data, function(d){return(d.AGEGROUP)}).keys()
  //console.log(groups)

  // Add X axis
  var x = d3.scaleBand()
      .domain(groups)
      .range([0, width+20])
      .padding([0.2])
  svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x).tickSizeOuter(0));

  //
  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, domain])
    .range([ height, 0 ]);
  svg.append("g")
    .call(d3.axisLeft(y));

	var color = d3.scaleOrdinal()
	  .domain(subgroups)
	  .range(['red','blue','green','orange','yellow','black'])


  //stack the data? --> stack per subgroup
  var stackedData = d3.stack()
    .keys(subgroups)
    (data)

  // Show the bars
  if (demographic=='age') {
	  svg.append("g")
	    .selectAll("g")
	    // Enter in the stack data = loop key per key = group per group
	    .data(stackedData)
	    .enter().append("g")
	      .attr("fill", function(d) { return color(d.key); })
	      .selectAll("rect")
	      // enter a second time = loop subgroup per subgroup to add all rectangles
	      .data(function(d) { return d; })
	      .enter().append("rect")
	        .attr("x", function(d) { return x(d.data.AGEGROUP); })
	        .attr("y", function(d) { return y(d[1]); })
	        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
	        .attr("width",x.bandwidth())
	}
	else if (demographic=='sex') {
  	  svg.append("g")
  	    .selectAll("g")
  	    // Enter in the stack data = loop key per key = group per group
  	    .data(stackedData)
  	    .enter().append("g")
  	      .attr("fill", function(d) { return color(d.key); })
  	      .selectAll("rect")
  	      // enter a second time = loop subgroup per subgroup to add all rectangles
  	      .data(function(d) { return d; })
  	      .enter().append("rect")
  	        .attr("x", function(d) { return x(d.data.SEX); })
  	        .attr("y", function(d) { return y(d[1]); })
  	        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
  	        .attr("width",x.bandwidth())
  	}
	else  if (demographic=='race') {
  	  svg.append("g")
  	    .selectAll("g")
  	    // Enter in the stack data = loop key per key = group per group
  	    .data(stackedData)
  	    .enter().append("g")
  	      .attr("fill", function(d) { return color(d.key); })
  	      .selectAll("rect")
  	      // enter a second time = loop subgroup per subgroup to add all rectangles
  	      .data(function(d) { return d; })
  	      .enter().append("rect")
  	        .attr("x", function(d) { return x(d.data.RACE); })
  	        .attr("y", function(d) { return y(d[1]); })
  	        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
  	        .attr("width",x.bandwidth())
  	}

})
}
</script>
</div>

<div style="float:right">
<div class="dropdown">
  <button onclick="myFunction4()" class="dropbtn">Please select demographic:</button>
  <div id="myDropdown4" class="dropdown-content">
    <a href="#home" onclick=colorGraph2('age')>Age Group</a>
    <a href="#about" onclick=colorGraph2('sex')>Sex</a>
    <a href="#contact" onclick=colorGraph2('race')>Race</a>
  </div>
</div>
<script>
function myFunction4() {
  document.getElementById("myDropdown4").classList.toggle("show");
}
</script>
<p> <!--blank line to put button on top --> </p>

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<svg id="my_dataviz4" width="600" height="400"></svg>
<script>
function colorGraph2(demographic) {

// set the dimensions and margins of the graph
var margin = {top: 10, right: 30, bottom: 20, left: 50},
    width = 460 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;

// append the svg object to the body of the page
$("#my_dataviz4").empty();
var svg = d3.select("#my_dataviz4")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");


// Parse the Data
var urls = ["https://raw.githubusercontent.com/matthewlombardo/HCIProject2/master/graph1AGE.csv","https://raw.githubusercontent.com/matthewlombardo/HCIProject2/master/graph1SEX.csv","https://raw.githubusercontent.com/matthewlombardo/HCIProject2/master/graph1RACE.csv"];
var filename;
if (demographic=='age') {
	filename = urls[0];
}
else if (demographic=='sex'){
	filename = urls[1];
}
else if (demographic=='race'){
	filename = urls[2];
}

d3.csv(filename, function(data) {

  // List of subgroups = header of the csv files = soil condition here
  var subgroups = data.columns.slice(1)
  console.log(subgroups)

  // List of groups = species here = value of the first column called group -> I show them on the X axis
  var groups;
  var domain;
  if (demographic=='age') {
	  groups = d3.map(data, function(d){return(d.AGEGROUP)}).keys()
	  domain = 1000000;
  }
  else if (demographic=='sex'){
	  groups = d3.map(data, function(d){return(d.SEX)}).keys()
	  domain = 2500000;
  }
  else if (demographic=='race'){
	  groups = d3.map(data, function(d){return(d.RACE)}).keys()
	  domain = 3500000;
  }
  //var groups = d3.map(data, function(d){return(d.AGEGROUP)}).keys()
  //console.log(groups)

  // Add X axis
  var x = d3.scaleBand()
      .domain(groups)
      .range([0, width+20])
      .padding([0.2])
  svg.append("g")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.axisBottom(x).tickSizeOuter(0));

  //
  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, domain])
    .range([ height, 0 ]);
  svg.append("g")
    .call(d3.axisLeft(y));

	var color = d3.scaleOrdinal()
	  .domain(subgroups)
	  .range(['red','blue','green','orange','yellow','black'])


  //stack the data? --> stack per subgroup
  var stackedData = d3.stack()
    .keys(subgroups)
    (data)

  // Show the bars
  if (demographic=='age') {
	  svg.append("g")
	    .selectAll("g")
	    // Enter in the stack data = loop key per key = group per group
	    .data(stackedData)
	    .enter().append("g")
	      .attr("fill", function(d) { return color(d.key); })
	      .selectAll("rect")
	      // enter a second time = loop subgroup per subgroup to add all rectangles
	      .data(function(d) { return d; })
	      .enter().append("rect")
	        .attr("x", function(d) { return x(d.data.AGEGROUP); })
	        .attr("y", function(d) { return y(d[1]); })
	        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
	        .attr("width",x.bandwidth())
	}
	else if (demographic=='sex') {
  	  svg.append("g")
  	    .selectAll("g")
  	    // Enter in the stack data = loop key per key = group per group
  	    .data(stackedData)
  	    .enter().append("g")
  	      .attr("fill", function(d) { return color(d.key); })
  	      .selectAll("rect")
  	      // enter a second time = loop subgroup per subgroup to add all rectangles
  	      .data(function(d) { return d; })
  	      .enter().append("rect")
  	        .attr("x", function(d) { return x(d.data.SEX); })
  	        .attr("y", function(d) { return y(d[1]); })
  	        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
  	        .attr("width",x.bandwidth())
  	}
	else  if (demographic=='race') {
  	  svg.append("g")
  	    .selectAll("g")
  	    // Enter in the stack data = loop key per key = group per group
  	    .data(stackedData)
  	    .enter().append("g")
  	      .attr("fill", function(d) { return color(d.key); })
  	      .selectAll("rect")
  	      // enter a second time = loop subgroup per subgroup to add all rectangles
  	      .data(function(d) { return d; })
  	      .enter().append("rect")
  	        .attr("x", function(d) { return x(d.data.RACE); })
  	        .attr("y", function(d) { return y(d[1]); })
  	        .attr("height", function(d) { return y(d[0]) - y(d[1]); })
  	        .attr("width",x.bandwidth())
  	}

})
}
</script>
</div>


<hr style="clear:both;">

<!-- -->
<!-- BUBBLES -->
<!-- -->


<h2>Part III: Distance to Polling Places</h2>
<p>DESCRIPTION OF WHAT THIS IS</p>


<div style="float:left">
<div class="dropdown">
  <button onclick="myFunction5()" class="dropbtn">Please select bubble color!</button>
  <div id="myDropdown5" class="dropdown-content">
    <a href="#home" onclick=bubbler1('one')>Color Scheme 1</a>
    <a href="#about" onclick=bubbler1('two')>Color Scheme 2</a>
    <a href="#contact" onclick=bubbler1('three')>Color Scheme 3</a>
  </div>
</div>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Color palette -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<!-- Instantiate svg object -->
<style>
.node:hover{
  stroke-width: 7px !important;
  opacity: 1 !important;
}
</style>

<script>
function myFunction5() {
  document.getElementById("myDropdown5").classList.toggle("show");
}
</script>

<p><!-- blank line to put button on top --> </p>
<svg id="my_dataviz5" width="400" height="400"></svg>

<script>
function bubbler1(scheme) {
	// set the dimensions and margins of the graph
	var width = 460
	var height = 460

	// append the svg object to the body of the page
	var svg = d3.select("#my_dataviz5")
	  .append("svg")
	    .attr("width", width)
	    .attr("height", height)

	// Read data
	d3.csv("https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/11_SevCatOneNumNestedOneObsPerGroup.csv", function(data) {

	  // Filter a bit the data -> more than 1 million inhabitants
	  data = data.filter(function(d){ return d.value>10000000 })

	  // Testing if statements
	  if (scheme=='one') {
	  // Color palette for continents?
	  var color = d3.scaleOrdinal()
	    .domain(["Asia", "Europe", "Africa", "Oceania", "Americas"])
	    .range(d3.schemeSet1);
	  }

	  if (scheme=='two') {
	  // Color palette for continents?
	  var color = d3.scaleOrdinal()
	    .domain(["Asia", "Europe", "Africa", "Oceania", "Americas"])
	    .range(d3.schemeSet2);
	  }

	  if (scheme=='three') {
	  // Color palette for continents?
	  var color = d3.scaleOrdinal()
	    .domain(["Asia", "Europe", "Africa", "Oceania", "Americas"])
	    .range(d3.schemeSet3);
	  }

	  // Size scale for countries
	  var size = d3.scaleLinear()
	    .domain([0, 1400000000])
	    .range([7,55])  // circle will be between 7 and 55 px wide

	  // create a tooltip
	  var Tooltip = d3.select("#my_dataviz5")
	    .append("div")
	    .style("opacity", 0)
	    .attr("class", "tooltip")
	    .style("background-color", "white")
	    .style("border", "solid")
	    .style("border-width", "2px")
	    .style("border-radius", "5px")
	    .style("padding", "5px")

	  // Three function that change the tooltip when user hover / move / leave a cell
	  var mouseover = function(d) {
	    Tooltip
	      .style("opacity", 1)
	  }
	  var mousemove = function(d) {
	    Tooltip
	      .html('<u>' + d.key + '</u>' + "<br>" + d.value + " inhabitants")
	      .style("left", (d3.mouse(this)[0]+20) + "px")
	      .style("top", (d3.mouse(this)[1]) + "px")
	  }
	  var mouseleave = function(d) {
	    Tooltip
	      .style("opacity", 0)
	  }

	  // Initialize the circle: all located at the center of the svg area
	  var node = svg.append("g")
	    .selectAll("circle")
	    .data(data)
	    .enter()
	    .append("circle")
	      .attr("class", "node")
	      .attr("r", function(d){ return size(d.value)})
	      .attr("cx", width / 2)
	      .attr("cy", height / 2)
	      .style("fill", function(d){ return color(d.region)})
	      .style("fill-opacity", 0.8)
	      .attr("stroke", "black")
	      .style("stroke-width", 1)
	      .on("mouseover", mouseover) // What to do when hovered
	      .on("mousemove", mousemove)
	      .on("mouseleave", mouseleave)
	      .call(d3.drag() // call specific function when circle is dragged
	           .on("start", dragstarted)
	           .on("drag", dragged)
	           .on("end", dragended));

	  // Features of the forces applied to the nodes:
	  var simulation = d3.forceSimulation()
	      .force("center", d3.forceCenter().x(width / 2).y(height / 2)) // Attraction to the center of the svg area
	      .force("charge", d3.forceManyBody().strength(.1)) // Nodes are attracted one each other of value is > 0
	      .force("collide", d3.forceCollide().strength(.2).radius(function(d){ return (size(d.value)+3) }).iterations(1)) // Force that avoids circle overlapping

	  // Apply these forces to the nodes and update their positions.
	  // Once the force algorithm is happy with positions ('alpha' value is low enough), simulations will stop.
	  simulation
	      .nodes(data)
	      .on("tick", function(d){
	        node
	            .attr("cx", function(d){ return d.x; })
	            .attr("cy", function(d){ return d.y; })
	      });

	  // What happens when a circle is dragged?
	  function dragstarted(d) {
	    if (!d3.event.active) simulation.alphaTarget(.03).restart();
	    d.fx = d.x;
	    d.fy = d.y;
	  }
	  function dragged(d) {
	    d.fx = d3.event.x;
	    d.fy = d3.event.y;
	  }
	  function dragended(d) {
	    if (!d3.event.active) simulation.alphaTarget(.03);
	    d.fx = null;
	    d.fy = null;
	  }

	})
}

</script>
</div>

<div style="float:right">
<div class="dropdown">
  <button onclick="myFunction6()" class="dropbtn">Please select bubble color!</button>
  <div id="myDropdown6" class="dropdown-content">
    <a href="#home" onclick=bubbler2('one')>Color Scheme 1</a>
    <a href="#about" onclick=bubbler2('two')>Color Scheme 2</a>
    <a href="#contact" onclick=bubbler2('three')>Color Scheme 3</a>
  </div>
</div>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Color palette -->
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<!-- Instantiate svg object -->
<style>
.node:hover{
  stroke-width: 7px !important;
  opacity: 1 !important;
}
</style>

<script>
function myFunction6() {
  document.getElementById("myDropdown6").classList.toggle("show");
}
</script>

<p><!-- blank line to put button on top --> </p>

<svg id="my_dataviz6" width="400" height="400"></svg>

<script>
function bubbler2(scheme) {
	// set the dimensions and margins of the graph
	var width = 460
	var height = 460

	// append the svg object to the body of the page
	var svg = d3.select("#my_dataviz6")
	  .append("svg")
	    .attr("width", width)
	    .attr("height", height)

	// Read data
	d3.csv("https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/11_SevCatOneNumNestedOneObsPerGroup.csv", function(data) {

	  // Filter a bit the data -> more than 1 million inhabitants
	  data = data.filter(function(d){ return d.value>10000000 })

	  // Testing if statements
	  if (scheme=='one') {
	  // Color palette for continents?
	  var color = d3.scaleOrdinal()
	    .domain(["Asia", "Europe", "Africa", "Oceania", "Americas"])
	    .range(d3.schemeSet1);
	  }

	  if (scheme=='two') {
	  // Color palette for continents?
	  var color = d3.scaleOrdinal()
	    .domain(["Asia", "Europe", "Africa", "Oceania", "Americas"])
	    .range(d3.schemeSet2);
	  }

	  if (scheme=='three') {
	  // Color palette for continents?
	  var color = d3.scaleOrdinal()
	    .domain(["Asia", "Europe", "Africa", "Oceania", "Americas"])
	    .range(d3.schemeSet3);
	  }

	  // Size scale for countries
	  var size = d3.scaleLinear()
	    .domain([0, 1400000000])
	    .range([7,55])  // circle will be between 7 and 55 px wide

	  // create a tooltip
	  var Tooltip = d3.select("#my_dataviz6")
	    .append("div")
	    .style("opacity", 0)
	    .attr("class", "tooltip")
	    .style("background-color", "white")
	    .style("border", "solid")
	    .style("border-width", "2px")
	    .style("border-radius", "5px")
	    .style("padding", "5px")

	  // Three function that change the tooltip when user hover / move / leave a cell
	  var mouseover = function(d) {
	    Tooltip
	      .style("opacity", 1)
	  }
	  var mousemove = function(d) {
	    Tooltip
	      .html('<u>' + d.key + '</u>' + "<br>" + d.value + " inhabitants")
	      .style("left", (d3.mouse(this)[0]+20) + "px")
	      .style("top", (d3.mouse(this)[1]) + "px")
	  }
	  var mouseleave = function(d) {
	    Tooltip
	      .style("opacity", 0)
	  }

	  // Initialize the circle: all located at the center of the svg area
	  var node = svg.append("g")
	    .selectAll("circle")
	    .data(data)
	    .enter()
	    .append("circle")
	      .attr("class", "node")
	      .attr("r", function(d){ return size(d.value)})
	      .attr("cx", width / 2)
	      .attr("cy", height / 2)
	      .style("fill", function(d){ return color(d.region)})
	      .style("fill-opacity", 0.8)
	      .attr("stroke", "black")
	      .style("stroke-width", 1)
	      .on("mouseover", mouseover) // What to do when hovered
	      .on("mousemove", mousemove)
	      .on("mouseleave", mouseleave)
	      .call(d3.drag() // call specific function when circle is dragged
	           .on("start", dragstarted)
	           .on("drag", dragged)
	           .on("end", dragended));

	  // Features of the forces applied to the nodes:
	  var simulation = d3.forceSimulation()
	      .force("center", d3.forceCenter().x(width / 2).y(height / 2)) // Attraction to the center of the svg area
	      .force("charge", d3.forceManyBody().strength(.1)) // Nodes are attracted one each other of value is > 0
	      .force("collide", d3.forceCollide().strength(.2).radius(function(d){ return (size(d.value)+3) }).iterations(1)) // Force that avoids circle overlapping

	  // Apply these forces to the nodes and update their positions.
	  // Once the force algorithm is happy with positions ('alpha' value is low enough), simulations will stop.
	  simulation
	      .nodes(data)
	      .on("tick", function(d){
	        node
	            .attr("cx", function(d){ return d.x; })
	            .attr("cy", function(d){ return d.y; })
	      });

	  // What happens when a circle is dragged?
	  function dragstarted(d) {
	    if (!d3.event.active) simulation.alphaTarget(.03).restart();
	    d.fx = d.x;
	    d.fy = d.y;
	  }
	  function dragged(d) {
	    d.fx = d3.event.x;
	    d.fy = d3.event.y;
	  }
	  function dragended(d) {
	    if (!d3.event.active) simulation.alphaTarget(.03);
	    d.fx = null;
	    d.fy = null;
	  }

	})
}

</script>
</div>


<hr style="clear:both;">


<h3>References</h3>

We borrowed d3.js code from the following sources:

<p></p>

Part I: <a href="https://www.d3-graph-gallery.com/graph/choropleth_basic.html">https://www.d3-graph-gallery.com/graph/choropleth_basic.html</a>

<p></p>

Part II: <a href="https://www.d3-graph-gallery.com/graph/barplot_stacked_basicWide.html">https://www.d3-graph-gallery.com/graph/barplot_stacked_basicWide.html</a>

<p></p>

Part III: <a href="https://www.d3-graph-gallery.com/graph/circularpacking_template.html">https://www.d3-graph-gallery.com/graph/circularpacking_template.html</a>
</div>
</body>


</html>
